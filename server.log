INFO:root:Loading model...
INFO:2026-01-14 00:20:49,073:jax._src.xla_bridge:945: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
INFO:jax._src.xla_bridge:Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
INFO:2026-01-14 00:20:49,076:jax._src.xla_bridge:945: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
INFO:jax._src.xla_bridge:Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
INFO:absl:orbax-checkpoint version: 0.11.1
INFO:absl:Created BasePyTreeCheckpointHandler: pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=None
INFO:absl:Restoring checkpoint from /Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-120' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 4304, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_0.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 4304],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 4304],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [4304]],\n    'input_inclusive_min': [0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 4304, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_0.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 4304],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 4304],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [4304]],
    'input_inclusive_min': [0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-98' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.q_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 8, 2048, 256],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 8, 2048, 256],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [8], [2048], [256]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.q_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 8, 2048, 256],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 8, 2048, 256],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [8], [2048], [256]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-84' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 16, 1), slice(0, 72, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.out.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 16, 72, 1152],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 16, 72, 1152],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [16], [72], [1152]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 16, 1), slice(0, 72, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.out.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 16, 72, 1152],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 16, 72, 1152],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [16], [72], [1152]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-123' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 4304, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_1.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 4304, 1152],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 4304, 1152],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [4304], [1152]],\n    'input_inclusive_min': [0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 4304, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_1.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 4304, 1152],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 4304, 1152],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [4304], [1152]],
    'input_inclusive_min': [0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-88' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.value.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.value.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-130' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.value.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.value.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-134' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 16, 1), slice(0, 72, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.out.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 16, 72, 1152],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 16, 72, 1152],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [16], [72], [1152]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 16, 1), slice(0, 72, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.out.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 16, 72, 1152],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 16, 72, 1152],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [16], [72], [1152]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-82' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.key.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.key.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-110' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 1, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.kv_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 2, 1, 2048, 256],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 2, 1, 2048, 256],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [2], [1], [2048], [256]],\n    'input_inclusive_min': [0, 0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 1, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.kv_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 2, 1, 2048, 256],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 1, 2048, 256],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [1], [2048], [256]],
    'input_inclusive_min': [0, 0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-96' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 256, 1), slice(0, 2048, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.attn_vec_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 8, 256, 2048],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 8, 256, 2048],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [8], [256], [2048]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 256, 1), slice(0, 2048, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.attn_vec_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 8, 256, 2048],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 8, 256, 2048],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [8], [256], [2048]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-132' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.query.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.query.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-97' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 1, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.kv_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 2, 1, 2048, 256],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 2, 1, 2048, 256],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [2], [1], [2048], [256]],\n    'input_inclusive_min': [0, 0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 1, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.kv_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 2, 1, 2048, 256],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 1, 2048, 256],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [1], [2048], [256]],
    'input_inclusive_min': [0, 0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-127' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.key.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.key.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-86' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.query.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 16, 72],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 16, 72],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [16], [72]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 16, 1), slice(0, 72, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MultiHeadDotProductAttention_0.query.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 16, 72],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 16, 72],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [16], [72]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-78' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 4304, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_0.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 1152, 4304],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 1152, 4304],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [1152], [4304]],\n    'input_inclusive_min': [0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 1152, 1), slice(0, 4304, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_0.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 1152, 4304],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 1152, 4304],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [1152], [4304]],
    'input_inclusive_min': [0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-108' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.q_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 8, 2048, 256],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 8, 2048, 256],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [8], [2048], [256]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 2048, 1), slice(0, 256, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.q_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 8, 2048, 256],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 8, 2048, 256],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [8], [2048], [256]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-113' coro=<_read_array_index_and_device_put() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:435> exception=Exception("Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 256, 1), slice(0, 2048, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'float32',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.llm.layers.attn.attn_vec_einsum.w.value/',\n    },\n    'metadata': {\n      'chunks': [18, 8, 256, 2048],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': '<f4',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [18, 8, 256, 2048],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[18], [8], [256], [2048]],\n    'input_inclusive_min': [0, 0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 8, 1), slice(0, 256, 1), slice(0, 2048, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.attn.attn_vec_einsum.w.value/',
    },
    'metadata': {
      'chunks': [18, 8, 256, 2048],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 8, 256, 2048],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [8], [256], [2048]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
ERROR:asyncio:unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-80' coro=<async_deserialize() done, defined at /Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py:548> exception=Exception("Encountered error while reading array index: (slice(0, 27, 1), slice(0, 4304, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({\n  'base': {\n    'driver': 'zarr',\n    'dtype': 'bfloat16',\n    'fill_missing_data_reads': False,\n    'kvstore': {\n      'base': {\n        'driver': 'file',\n        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',\n      },\n      'cache_pool': 'cache_pool#ocdbt',\n      'config': {\n        'compression': {'id': 'zstd'},\n        'max_decoded_node_bytes': 100000000,\n        'max_inline_value_bytes': 1024,\n        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',\n        'version_tree_arity_log2': 4,\n      },\n      'driver': 'ocdbt',\n      'experimental_read_coalescing_interval': '1ms',\n      'experimental_read_coalescing_merged_bytes': 500000000000,\n      'experimental_read_coalescing_threshold_bytes': 1000000,\n      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_1.kernel.value/',\n    },\n    'metadata': {\n      'chunks': [27, 4304, 1152],\n      'compressor': {'id': 'zstd', 'level': 1},\n      'dimension_separator': '.',\n      'dtype': 'bfloat16',\n      'fill_value': None,\n      'filters': None,\n      'order': 'C',\n      'shape': [27, 4304, 1152],\n      'zarr_format': 2,\n    },\n    'recheck_cached_data': False,\n    'recheck_cached_metadata': False,\n  },\n  'context': {\n    'cache_pool': {},\n    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},\n    'data_copy_concurrency': {},\n    'file_io_concurrency': {'limit': 128},\n    'file_io_locking': {},\n    'file_io_memmap': False,\n    'file_io_sync': True,\n    'ocdbt_coordinator': {},\n  },\n  'driver': 'cast',\n  'dtype': 'bfloat16',\n  'transform': {\n    'input_exclusive_max': [[27], [4304], [1152]],\n    'input_inclusive_min': [0, 0, 0],\n  },\n})>.")>
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 27, 1), slice(0, 4304, 1), slice(0, 1152, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'bfloat16',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.img.Transformer.encoderblock.MlpBlock_0.Dense_1.kernel.value/',
    },
    'metadata': {
      'chunks': [27, 4304, 1152],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': 'bfloat16',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [27, 4304, 1152],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[27], [4304], [1152]],
    'input_inclusive_min': [0, 0, 0],
  },
})>.
Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 482, in _read_array_index_and_device_put
    shard = await _read_shard(
            ^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 425, in _read_shard
    await ts.array(out)[ts.d[:].translate_to[requested_domain.origin]][
ValueError: Error reading "params.PaliGemma.llm.layers.mlp.gating_einsum.value/0.0.0.2" in OCDBT database at local file "/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/": Error reading from open file: Failed to read from file [OS error 22: EINVAL Invalid argument] [source locations='tensorstore/internal/os/file_util_posix.cc:271\ntensorstore/kvstore/file/file_key_value_store.cc:420\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/kvstore/file/file_key_value_store.cc:471\ntensorstore/internal/cache/kvs_backed_cache.h:208']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/scripts/serve_policy_ricl.py", line 106, in <module>
    main(tyro.cli(Args))
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/scripts/serve_policy_ricl.py", line 84, in main
    policy = create_policy(args)
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/scripts/serve_policy_ricl.py", line 69, in create_policy
    return _policy_config.create_trained_ricl_policy(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/src/openpi/policies/policy_config.py", line 112, in create_trained_ricl_policy
    model = train_config.model.load(_model.restore_params(f"{checkpoint_dir}/params", dtype=jnp.bfloat16))
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/src/openpi/models/model.py", line 830, in restore_params
    params = ckptr.restore(
             ^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/checkpointers/checkpointer.py", line 258, in restore
    restored = self._restore(directory, args=ckpt_args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/checkpointers/checkpointer.py", line 272, in _restore
    return self._handler.restore(directory, args=args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/pytree_checkpoint_handler.py", line 796, in restore
    return self._handler_impl.restore(directory, args=args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 733, in restore
    tree_memory_size, restored_item = asyncio_utils.run_sync(
                                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 50, in run_sync
    return asyncio.run(coro)
           ^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/.local/share/uv/python/cpython-3.11.13-macos-aarch64-none/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 581, in _maybe_deserialize
    deserialized_batches += await asyncio.gather(*deserialized_batches_ops)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/type_handlers.py", line 1224, in deserialize
    ret = await asyncio.gather(*deserialize_ops)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 585, in async_deserialize
    return await read_and_create_array(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 544, in read_and_create_array
    dbs = sum(await asyncio.gather(*read_array_coros), [])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sbae703/startups/meural/sim/ricl_openpi/.venv/lib/python3.11/site-packages/orbax/checkpoint/_src/serialization/serialization.py", line 490, in _read_array_index_and_device_put
    raise Exception(  # pylint: disable=broad-exception-raised
Exception: Encountered error while reading array index: (slice(0, 18, 1), slice(0, 2, 1), slice(0, 2048, 1), slice(0, 16384, 1)). See full TensorStore details: <bound method PyCapsule.spec of TensorStore({
  'base': {
    'driver': 'zarr',
    'dtype': 'float32',
    'fill_missing_data_reads': False,
    'kvstore': {
      'base': {
        'driver': 'file',
        'path': '/Users/sbae703/startups/meural/sim/ricl_openpi/checkpoints/pi0_fast_droid_ricl_checkpoint/params/',
      },
      'cache_pool': 'cache_pool#ocdbt',
      'config': {
        'compression': {'id': 'zstd'},
        'max_decoded_node_bytes': 100000000,
        'max_inline_value_bytes': 1024,
        'uuid': 'cbbe0cb1d51e3372caf1037a39488d90',
        'version_tree_arity_log2': 4,
      },
      'driver': 'ocdbt',
      'experimental_read_coalescing_interval': '1ms',
      'experimental_read_coalescing_merged_bytes': 500000000000,
      'experimental_read_coalescing_threshold_bytes': 1000000,
      'path': 'params.PaliGemma.llm.layers.mlp.gating_einsum.value/',
    },
    'metadata': {
      'chunks': [18, 2, 2048, 4096],
      'compressor': {'id': 'zstd', 'level': 1},
      'dimension_separator': '.',
      'dtype': '<f4',
      'fill_value': None,
      'filters': None,
      'order': 'C',
      'shape': [18, 2, 2048, 16384],
      'zarr_format': 2,
    },
    'recheck_cached_data': False,
    'recheck_cached_metadata': False,
  },
  'context': {
    'cache_pool': {},
    'cache_pool#ocdbt': {'total_bytes_limit': 100000000},
    'data_copy_concurrency': {},
    'file_io_concurrency': {'limit': 128},
    'file_io_locking': {},
    'file_io_memmap': False,
    'file_io_sync': True,
    'ocdbt_coordinator': {},
  },
  'driver': 'cast',
  'dtype': 'bfloat16',
  'transform': {
    'input_exclusive_max': [[18], [2], [2048], [16384]],
    'input_inclusive_min': [0, 0, 0, 0],
  },
})>.
